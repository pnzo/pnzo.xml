# Команды

Задание на расчет в программе состоит из более мелких структурных элементов - *команд*, которые описывают сущность выполняемой задачи, например, расчет динамической и статической устойчивости, построение графиков переходных процессов, поиск шунта, утяжеление режима и т.д. Таких команд в задании может быть неограниченно много (в разумных пределах). Шаблоны для задания команд находятся в контекстном меню текстового поля (правая кнопка мыши)

### Общая информация

**Элемент команды** обязательно состоит из следующих компонентов:
1. **Тег команды** - указывает программе на тип желаемого действия. На данный момент доступны следующие теги: 
   + `<stability>` - расчет динамической устойчивости
   + `<graph>` - вывод графиков переходных процессов
   + `<write>` - изменение расчетной модели   

Каждый тег, должен быть обязательно закрыт, то есть выглядеть так: `<stability>...</stability>`, либо, если вложенные элементы не требуются, то так: `</stability>`

В примере ниже `<stability>` - открывающий тег, `</stability>` - закрывающий тег для основного элемента, `<folder/>` - тег вложенного элемента, он является одновременно открывающим и закрывающим, так как сам не содержит вложенных элементов
```xml
	<stability name="Динамическая устойчивость">
		<folder path="default" var="rst,scn"/>
	</stability>
```

2. **Параметры команды** - указывают программе на исходные данные, необходимые в процессе выполнения. Делятся на:
   + обязательные - без указания этих параметров команда выполнятся не будет
   + необязательные - дополнительные исходные данные, без которых можно обойтись (пока таких параметров нет, но будут позже, наверно)

Каждый параметр имеет имя и значение, они разделяются знаком `=`, а значение помещается в двойные кавычки, вот структура: `name="value"`. 

Пример: 
```xml
	<write name="Изменение модели" table="node" column="uhom" selection="uhom=110" value="115">
		<file path="default\01.Нормальная схема сети.rst"/>
	</write>
```
В этом примере параметрами команды **write** являются *table, column, selection, value*

3. **Вложенные элементы** - указывают программе на исходные данные, логика которых довольно сложна и ее невозможно описать простым параметром. По разметке отличий от элемента команды нет, они тоже должны закрываться, могут иметь параметры, вложенные элементы и т.д.

Пример: 
```xml
	<graph name = "графики">
		<plot name="Напряжения">
			<curve name="КТЭЦ-2" table="node" column="vras" selection="ny=301"/>
			<curve name="Советск" table="node" column="vras" selection="ny=40707301"/>
			<curve name="ПТЭС" table="node" column="vras" selection="ny=40707260"/>
		</plot>
		<files>
			<file path="default\02.В ремонте Л-326.rst"/>
			<file path="default\Отключение Л-442 действием УРОВ при К11 с отказом ВЛ-442.scn"/>
		</files>
	</graph>
```
В этом примере вложенными элементами команды **write** являются **plot**, **files**. В свою очередь, элемент **plot** содержит 2 вложенных элемента **curve**, элемент **files** содержит 2 вложенных элемента **file**

### stability
#### Расчет динамической устойчивости
Производит простой расчет переходного процесса с проверкой на наличие динамической устойчивости

Имеет один параметр:
   + *name* - задает имя для команды

Пример:
```xml
	<stability name="Динамическая устойчивость">
		<folder path="default" var="rst,scn"/>
	</stability>
```  
### write
#### Изменение расчетной модели
Записывает в таблицы RastrWIN значение по выборке, пересохраняет файлы расчетной модели

Параметры:
   + *name* - задает имя для команды
   + *table* - указывает таблицу
   + *column* - указывает столбец
   + *selection* - описывает выборку строк
   + *value* - задает новое значение
   
Пример:
```xml
	<write 	name="Изменение модели" 
			table="node" 
			column="uhom" 
			selection="uhom=110"
			value="115">
		<file path="default\01.Нормальная схема сети.rst"/>
	</write>
```  
### graph
#### Вывод графиков переходного процесса

Параметры:
   + *name* - задает имя для команды
   
Вложенный элемент:
   + *plot* - описывает формат графика
   
Параметры элемента **plot**:
   + *name* - задает имя для команды
   
Вложенные элементы **plot**: 
   + *curve* - описывает формат кривой
   
Параметры элемента **curve**:  
   + *name* - задает имя кривой
   + *table* - указывает таблицу
   + *column* - указывает столбец
   + *selection* - описывает выборку строк, если несколько строк попало в выборку, берет первую
   
Пример:
```xml
	<graph name = "графики">
		<!--- Описание графиков -->
		<plot name="Напряжения">
			<curve name="КТЭЦ-2" table="node" column="vras" selection="ny=301"/>
			<curve name="Советск" table="node" column="vras" selection="ny=40707301"/>
			<curve name="ПТЭС" table="node" column="vras" selection="ny=40707260"/>
		</plot>
		<plot name="Углы роторов">
			<curve name="КТЭЦ-2" table="Generator" column="Delta" selection="Num=40707602"/>
			<curve name="ПТЭС" table="Generator" column="Delta" selection="Num=40707262"/>
		</plot>
		<!--- Описание наборов файлов, попадающих в расчет -->		
		<files>
			<file path="default\01.Нормальная схема сети.rst"/>
			<file path="default\Отключение Л-441 действием УРОВ при К11 с отказом ВЛ-441.scn"/>
		</files>
		<files>
			<file path="default\02.В ремонте Л-326.rst"/>
			<file path="default\Отключение Л-442 действием УРОВ при К11 с отказом ВЛ-442.scn"/>
		</files>
	</graph>
```  
